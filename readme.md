# 声明：
此脚本仅适用于湖南大学疫情自动打卡，即https://fangkong.hnu.edu.cn/app

为达到疫情防控目的，使用时请如实填报，此脚本仅适用于完全正常的健康人士的每天打卡，如若出现状况，请自觉停用，并如实手动填报具体信息。

此脚本保证更新速度，更新日志会在最后放出，鉴于疫情发展速度，填报内容不尽相同，填报系统也在更新。本人尽量在空闲期间，对打卡页面的变更做出相应调整。



## 使用环境
### python
1. `pytesseract`
2. `PIL`
3. `requests`

以上三个库没有请自行下载

## 可控参数

> 配置文件1

```json
//config.json
{
  "getCookieAttempt": 15   //尝试设置cookie最大次数，为最大登录尝试次数，往往因验证码识别效率而定，稳一点的话可以考虑10到15次，默认5次
  "checkinAttempt": 10,    //尝试签到最大次数，视api而定，一般来说，10次就行
  "showStatus": true   //是否显示学校打卡情况
}
```

> 配置文件2

```
//postpara.json
找到如下参数：
{"IsInCampus": 1   //  1表示在校，0表示不在校，可根据实际情况更改}
***其它参数不建议私自更改，因为大概率会导致打卡失败！！
```


## 使用说明
### 配置你的学号与密码
>如果你熟悉json格式

```json
//UsrLib/Usr.json
{"学号1": {"pwd": "密码1"},"学号2": {"pwd": "密码2"},...}  //在对应位置输入学号与密码，如"111": {"pwd": "222"}支持多人一起打卡
```
>如果你不懂什么是json

　启动usrControl.py
　按照提示进行操作，如增加一个用户，依次输入：

　add 学号 密码

　之后按回车就行了

以上两种方式等价，只是针对不同对象选择适合自己的方法

>之后打开postpara.json文件

　以笔记本形式打开，找到前四个参数："RealProvince": "","RealCity": "","RealCounty": "","RealAddress": ""
 
　这四个参数分别对应四个信息，表示你当天的所在位置，分别是：省、市、区、具体位置。一般来说，都是在学校附近活动，所以这  
　四个参数配置一次即可，后续不用更改
 
　参考示例：　　"RealProvince": "河南省","RealCity": "郑州市","RealCounty": "中原区","RealAddress": "科学大道100号"
 
　*最后一个参数可视情况写具体一点，注意所有信息都要写在引号内*

### 运行

```bash
python multiCheckin.py
```

　*p.s. 如果打算每天定时打卡或者是每隔一段时间检测打卡情况写一个批处理就行了，或是使用系统自带的任务计划程序实现自动化（Windows系统）*

### debug

脚本自带一个事件记录模块，如果出现bug首先考虑查看`EVENT.TXT`文件排查错误。一般来说，如果出错，可能是打卡系统更新了，或者一些其它原因，可以向我反应。

### other

传播脚本之前请务必记得删除`UserLib`里的`pkl`文件、`EVENT.TXT`并通过`usrControl.py`（或者直接找//UsrLib/Usr.json进行清除，注意保留{}）**删除所有用户信息！！**

## 更新日志
### 　2021/8/30
　　\*　完善了headers，从而修复了偶尔打卡失败的bug。
  
### 　2021/8/27
　　\*　修复了一个bug，该bug曾导致“体温正常项”无法正常提交。
  
### 　2021/8
　　\*　新增"绿码"功能
  
　　\*　新增街道定位
  
　　\*　移除各种体温监测
  
　　\*　dailyinfo参数并入必要参数
  




